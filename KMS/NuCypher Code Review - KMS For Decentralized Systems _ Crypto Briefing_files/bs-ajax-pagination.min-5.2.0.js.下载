!function(e){"use strict";function a(a){a="undefined"==typeof a?!0:a,a&&e(window).scroll()}function n(a){return this.prefix="bs_ajax_paginate_",this.deferredPrefix="bs_deferred_loading_",this.isPrevPage=!1,this.$link_el=!1,this.id=!1,this.paginationStyle=!1,this.settings=e.extend({afterSuccessDeferredAjax:function(){}},a),this}var t,i={},s={};n.prototype.init=function(a){var n=this;e(a).on("click",".bs-ajax-pagination a",function(a){a.preventDefault();var i=e(this),s=i.parent();if(i.hasClass("disabled")||s.hasClass("bs-pagination-loading"))return!1;s.addClass("bs-pagination-loading");var r=i.closest(".bs-pagination");n.$link_el=i,n.id=i.data("id");try{if(!n.id)throw"invalid element";n.setNewPageNumber(),n.paginationStyle=n.getPaginationStyle();var d=n.getAjaxProps(),o=r.prevAll(".bs-pagination-wrapper"),l=n.cache_get(d.current_page,n.id);if("object"==typeof l)o.addClass("bs-pagination-cached"),n.handle_response(l),s.removeClass("bs-pagination-loading");else{switch(o.removeClass("bs-pagination-cached"),2==d.current_page&&n.cache_add(1,{output:o.html(),label:r.find(".bs-pagination-label").html(),have_next:!0,have_prev:!1},n.id),n.paginationStyle){case"next_prev":o.children().addClass("bs-pagination-in-loading"),o.prepend(n.getLoadingRawHtml());break;case"more_btn_infinity":i.find(".loaded").hide(),i.find(".loading").show(),i.removeClass("more_btn_infinity").addClass("infinity").addClass("bs-pagination-in-loading"),r.removeClass("more_btn_infinity").addClass("infinity");break;case"infinity":case"more_btn":i.addClass("bs-pagination-in-loading"),i.find(".loaded").hide(),i.find(".loading").show()}t=e.ajax({url:d.ajax_url,type:"POST",dataType:"json",data:d}).fail(function(e){switch(s.removeClass("bs-pagination-loading"),n.paginationStyle){case"more_btn_infinity":case"next_prev":o.find(".bs-pagin-loading-wrapper").remove(),i.addClass("bs-pagination-in-loading");break;case"infinity":case"more_btn":i.addClass("bs-pagination-in-loading"),i.find(".loaded").show(),i.find(".loading").hide()}"abort"!==e.statusText&&alert("cannot load data. please check your internet connection!")}).done(function(e){switch(n.handle_response(e),n.cacheThisStyle(n.paginationStyle)&&n.cache_add(d.current_page,e,n.id),n.paginationStyle){case"more_btn_infinity":i.removeClass("bs-pagination-in-loading"),o.find(".bs-pagin-loading-wrapper").remove();break;case"next_prev":i.removeClass("bs-pagination-in-loading"),o.find(".bs-pagin-loading-wrapper").remove(),o.children().removeClass("bs-pagination-in-loading");break;case"infinity":case"more_btn":i.removeClass("bs-pagination-in-loading"),i.find(".loaded").show(),i.find(".loading").hide()}s.removeClass("bs-pagination-loading")})}}catch(p){n.debug(p)}}),new OnScreen({tolerance:0,debounce:100,container:window}).on("enter",".bs-ajax-pagination.infinity",function(a){e(a).find("a").click()})},n.prototype.filter_slider_params=function(e){return"undefined"!=typeof e.autoplayspeed&&(e.autoplaySpeed=e.autoplayspeed),e.dots="undefined"!=typeof e.sliderControlDots&&"off"!==e.sliderControlDots,e.autoplay="undefined"!=typeof e.sliderAutoplay&&parseInt(e.sliderAutoplay),e.speed=e.sliderAnimationSpeed,"undefined"!=typeof e.sliderControlNextPrev&&"off"==e.sliderControlNextPrev&&(e.appendArrows=!1),e},n.prototype.handler_slider=function(n){var t=this;e.fn.slick&&(e(".bs-slider-items-container",n).each(function(){var a=e(this),n=e(document.body).hasClass("rtl");if(!a.hasClass("slick-ready")){var i=a.data(),s=t.filter_slider_params(e.extend({sliderControlDots:"off",prevArrow:'<a class="btn-bs-pagination prev" rel="prev" title="Previous">\n			<i class="fa fa-angle-'+(n?"right":"left")+'" aria-hidden="true"></i>\n		</a>',nextArrow:'<a rel="next" class="btn-bs-pagination next" title="Next">\n			<i class="fa fa-angle-'+(n?"left":"right")+'" aria-hidden="true"></i>\n		</a>',rtl:n,slideMargin:25,slide:".bs-slider-item",appendArrows:a.find(".bs-slider-controls .bs-control-nav"),classPrefix:"bs-slider-",dotsClass:"bs-slider-dots",customPaging:function(a,n){return e('<span class="bts-bs-dots-btn"></span>').text(n+1)}},i));s.sliderControlDots&&i.sliderControlDots&&(s.appendDots=a.find(".bs-slider-controls"),s.dotsClass+=" "+s.dotsClass+"-"+i.sliderControlDots),a.slick(s),a.addClass("slick-ready")}}),e(".multi-tab").on("shown.bs.tab",'a[data-toggle="tab"]:not([data-deferred-init])',function(n){var t=e(n.target).attr("href");e(t).find(".bs-slider-items-container").slick("setPosition"),a()}))},n.prototype.refreshLazyImages=function(){Publisher_Theme&&Publisher_Theme.refreshLazyImages&&Publisher_Theme.refreshLazyImages()},n.prototype.bindDeferredEvents=function(n){var t=200,i=this,s=0;e(".multi-tab",n).on("show.bs.tab","a[data-deferred-init]",function(){var a=e(this).closest(".multi-tab").find(".active").attr("href");t=e(a).height()}),e(".tabs-section",n).on("show.bs.tab","a[data-deferred-init]",function(){var a=e(this).closest(".tabs-section").find(".active:visible a").data("target"),n=e(a);t=n.height()}).on("show.bs.tab","a",function(){i.refreshLazyImages();var a=e(this).closest(".tabs-section").find(".active:visible a").data("target"),n=e(a),t=n.outerHeight();if(t){var r=n.closest(".tab-content");if(r.length){var d=Math.max(t,parseInt(r.outerHeight()));d=Math.max(d,s),r.css("min-height",d).data("bs-height",d),s=d}}}),e("a[data-deferred-init]",n).each(function(){var n=e(this),s=n.data("deferred-event")||"click";n.closest(".deferred-block-exclude").length>0||n.on(s,function(){var n=e(this),s=n.data("deferred-init"),r=e("#bsd_"+s),d=r.closest(".bs-deferred-container");if(r.hasClass("bs-deferred-load-wrapper"))if(r.hasClass("bs-deferred-loaded")){var o=r.closest(".bs-pinning-block.pinned").length;a(!o)}else d.removeClass("bs-tab-animated"),i.handleDeferredElements(r,{loadingHeight:t?t:void 0},function(){d.addClass("bs-tab-animated"),r.addClass("bs-deferred-loaded");var e=d.find(".bs-pagination");!t||e.length&&!e.hasClass("next_prev")||d.css("min-height",t),t=void 0})})})},n.prototype.handleDeferredElements=function(n,t,s){var r=this;n.hasClass("bs-deferred-load-wrapper")||(n=n.find(".bs-deferred-load-wrapper")),n.each(function(){var n=e(this);if(!n.hasClass("deferred-html-exists")){if(t=e.extend({loadingHeight:100,loadingMinHeight:0},t),!n.find(".deferred-loading-container").length){var d=e("<div></div>",{"class":"deferred-loading-container",height:t.loadingHeight}),o=n.find(".bs-pagination");!t.loadingMinHeight||o&&o.hasClass("more_btn")||d.css("min-height",t.loadingMinHeight),d.append(r.getLoadingRawHtml()),d.appendTo(n)}r.id=n.attr("id");var l=r.getAjaxProps("deferred");"object"==typeof i[r.id]&&i[r.id].abort(),i[r.id]=e.ajax({url:l.ajax_url,type:"POST",dataType:"json",data:l}).done(function(e){n.find(".deferred-loading-container").remove(),delete i[r.id],n.addClass("deferred-html-exists").append(e.output),r.handler_slider(n),s&&s.call(n,e);var t=n.closest(".bs-pinning-block.pinned").length;a(!t),r.settings.afterSuccessDeferredAjax.call(r,n,e)})}})},n.prototype.getLoadingRawHtml=function(){return'<div class="bs-pagin-loading-wrapper">'+bs_pagination_loc.loading+"</div>"},n.prototype.getAjaxProps=function(e){e=e||"pagination";var a,n="deferred"===e?this.deferredPrefix:this.prefix,t=n+this.id;if("undefined"==typeof window[t])throw"pagination settings not set";switch(a=jQuery.parseJSON(window[t]),a._data=a.data,e.toLowerCase()){case"pagination":a.action="pagination_ajax",a.current_page=this.$link_el.parent().data("current-page")||1,a.pagin_type=this.paginationStyle;break;case"deferred":a.action="deferred_loading",a.current_page=1}if(this.$link_el){var i=this.$link_el.closest(".bs-pagination").data("bs-pagin-data");i&&(a._data=i)}return a},n.prototype.setNewPageNumber=function(){var e=this.$link_el.parent(),a=e.data("current-page")||1;if(this.isPrevPage=this.$link_el.hasClass("prev"),this.isPrevPage){if(2>a)throw"Wrong page number!";a--}else a++;e.data("current-page",a)},n.prototype.debug=function(e){console.error(e)},n.prototype.cacheThisStyle=function(e){return"next_prev"===e},n.prototype.getPaginationStyle=function(){for(var e,a=["next_prev","more_btn","more_btn_infinity","infinity"],n=this.$link_el.closest(".bs-pagination"),t=0;t<a.length;t++)if(e=a[t],n.hasClass(e))return e;return""},n.prototype.cache_get=function(e,a){return"undefined"!=typeof s[a]&&"undefined"!=typeof s[a][e]?s[a][e]:void 0},n.prototype.cache_add=function(e,a,n){"undefined"==typeof s[n]&&(s[n]={}),s[n][e]=a},n.prototype.handle_event=function(e,a){if("object"!=typeof e.events)return!1;if("string"==typeof e.events[a]){var n=e.events[a];"function"==typeof window[n]&&window[n].call(this,e,a)}},n.prototype.handle_response=function(n){if(null===n||"string"==typeof n.error)return void(null===n?this.debug("Error!"):this.debug(n.error));var t=this.$link_el.closest(".bs-pagination"),i=t.prevAll(".bs-pagination-wrapper");n.data&&t.data("bs-pagin-data",n.data);var s=t.closest(".bs-pinning-block.pinned").length;switch(this.handle_event(n,"before_append"),this.paginationStyle){case"next_prev":i.html(n.output),this.handle_event(n,"after_append"),i.addClass("bs-animate").addClass(this.isPrevPage?"bs-fadeInLeft":"bs-fadeInRight").delay(400).queue(function(a){e(this).removeClass("bs-animate bs-fadeInRight bs-fadeInLeft"),a()}),a(!s),"undefined"!=typeof n.label&&t.find(".bs-pagination-label").html(n.label),t.find(".next")[n.have_next?"removeClass":"addClass"]("disabled"),t.find(".prev")[n.have_prev?"removeClass":"addClass"]("disabled");break;case"more_btn":case"more_btn_infinity":case"infinity":if("string"==typeof n["add-to"]){var r=e(n.output);"prepend"==n["add-type"]?i.find(n["add-to"]).prepend(r):i.find(n["add-to"]).append(r)}else var r=i.append(n.output).children(":last");a(!s),this.handle_event(n,"after_append"),r.addClass("bs-animate bs-fadeInUp").delay(400).queue(function(a){e(this).removeClass("bs-animate bs-fadeInUp"),a()}),"infinity"===this.paginationStyle?n.have_next||this.$link_el.unbind("inview").remove():n.have_next?this.$link_el.removeClass("disabled"):(this.$link_el.addClass("disabled"),this.$link_el.find(".loaded").remove(),this.$link_el.find(".no-more").show()),setTimeout(function(){if(e.fn.hcSticky)for(var a=i[0],n=0;8>=n&&(a&&a.parentElement);n++){if(a.parentElement.classList.contains("wrapper-sticky")){e(a).hcSticky("reinit");break}a=a.parentElement}}),i.closest("")}this.refreshLazyImages(),this.handle_event(n,"after_response")},e.fn.Better_Ajax_Pagination=function(e){return new n(e).handler_slider(),this.each(function(){(new n).init(this)})},e.fn.Better_Deferred_Loading=function(e){var a=new n(e);return a.bindDeferredEvents(e.context),a}}(jQuery);